(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fd4a994"],{"2fbb":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-container"},[n("el-tabs",{staticStyle:{"margin-top":"15px"},attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabMapOptions,(function(e){return n("el-tab-pane",{key:e.key,attrs:{label:e.label,name:e.key}},[n("keep-alive",[t.activeName==e.key?n("tab-pane",{attrs:{type:e.key}}):t._e()],1)],1)})),1)],1)},r=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{align:"center",label:"订单编号",width:"200","element-loading-text":"加载中！"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row._id))])]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"180px",align:"center",label:"日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("parseTime")(e.row.timestamp,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),n("el-table-column",{attrs:{"min-width":"240px",align:"center",label:"顾客信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{trigger:"hover",placement:"top"}},[n("p",[t._v("姓名: "+t._s(e.row.name))]),t._v(" "),n("p",[t._v("手机: "+t._s(e.row.tel))]),t._v(" "),n("p",[t._v("住址: "+t._s(e.row.address))]),t._v(" "),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("span",[t._v(t._s(e.row.name))])])])]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"100px",align:"center",label:"催单次数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.importance)+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"150px",align:"center",label:"总价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        ￥"+t._s(t._f("number")(e.row.price))+"\n      ")]}}])}),t._v(" "),n("el-table-column",{attrs:{width:"150px",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{type:t._f("statusFilter")(e.row.status)}},[t._v("\n          "+t._s(t._f("textFilter")(e.row.status))+"\n        ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{"class-name":"status-col",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return t.handleCheck(e.row)}}},[t._v("\n          查看详情\n        ")]),t._v(" "),1===e.row.status?n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(n){return t.handleDeliver(e)}}},[t._v("\n          已发货\n        ")]):t._e()]}}])})],1),t._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-size":t.listQuery.limit,layout:"prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.listQuery,"page",e)},"update:current-page":function(e){return t.$set(t.listQuery,"page",e)},"current-change":t.handleCurrentChange}})],1),t._v(" "),n("el-dialog",{attrs:{visible:t.dialogVisible,title:"商品列表"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticStyle:{"text-align":"right"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.order.goodsList,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"商品编号",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.id))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"商品名",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"商品描述",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.describe))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"商品价格",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("number")(e.row.price)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"订购数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.num))])]}}])})],1),t._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("\n        取消\n      ")])],1)])],1)},i=[],s=(n("96cf"),n("3b8d")),o=(n("6b54"),n("c5f6"),n("b775"));function u(t){return Object(o["a"])({url:"/orders/list",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/orders/update",method:"post",data:t})}var d=n("ed08"),p={filters:{statusFilter:function(t){var e={3:"success",2:"default",1:"warning"};return e[t]},textFilter:function(t){var e={3:"已完成",2:"已发货",1:"待发货"};return e[t]},number:function(t){var e=Number(t).toFixed(3),n=e.substring(0,e.toString().length-1);return n}},props:{type:{type:String,default:"0"}},data:function(){return{order:{},dialogVisible:!1,total:100,list:null,listQuery:{page:1,limit:10,status:this.type,sort:"+id"},loading:!1}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading=!0,this.$emit("create"),u(this.listQuery).then((function(e){t.list=e.data.items,t.total=e.data.total}))},handleCurrentChange:function(){this.getList()},handleCheck:function(t){this.order=t,this.dialogVisible=!0},handleDeliver:function(t){var e=this,n=t.$index,a=t.row;this.$confirm("确认已发货","确认操作",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=Object(d["c"])(a),c({id:r._id}).then((function(t){r.status=2;var a=e.$route.query.tab;if("1"===a)return e.list.splice(n,1),void(e.list.length<1&&e.getList());e.list.splice(n,1,r),e.$message({type:"success",message:"发货成功"})}));case 2:case"end":return t.stop()}}),t)})))).catch((function(t){console.log(t)}))}}},f=p,b=n("2877"),_=Object(b["a"])(f,l,i,!1,null,null,null),v=_.exports,g={name:"Orders",components:{tabPane:v},data:function(){return{tabMapOptions:[{label:"全部订单",key:"0"},{label:"待发货",key:"1"},{label:"待收货",key:"2"},{label:"已完成",key:"3"}],activeName:"0"}},watch:{activeName:function(t){this.$router.push("".concat(this.$route.path,"?tab=").concat(t))}},created:function(){var t=this.$route.query.tab;t&&(this.activeName=t)},methods:{}},h=g,m=(n("78a1"),Object(b["a"])(h,a,r,!1,null,"57630ce4",null));e["default"]=m.exports},"36d1":function(t,e,n){},"78a1":function(t,e,n){"use strict";var a=n("36d1"),r=n.n(a);r.a}}]);