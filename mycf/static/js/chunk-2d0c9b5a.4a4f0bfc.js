(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c9b5a"],{"59ff":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"30px"}},[n("el-row",[n("el-col",{attrs:{span:10}},[n("div",{staticStyle:{margin:"10px 0"}},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.listQuery.search.value,callback:function(t){e.$set(e.listQuery.search,"value",t)},expression:"listQuery.search.value"}},[n("el-select",{staticStyle:{width:"120px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.listQuery.search.key,callback:function(t){e.$set(e.listQuery.search,"key",t)},expression:"listQuery.search.key"}},[n("el-option",{attrs:{label:"用户名字",value:"name"}}),e._v(" "),n("el-option",{attrs:{label:"手机号码",value:"tel"}}),e._v(" "),n("el-option",{attrs:{label:"邮箱",value:"email"}})],1),e._v(" "),n("el-button",{attrs:{slot:"append",loading:e.loading,icon:"el-icon-search"},on:{click:function(t){return e.getList()}},slot:"append"})],1)],1)])],1),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.usersList,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"用户名字",width:"240","element-loading-text":"加载中！"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"240px",align:"center",label:"用户邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.email))])]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"240px",align:"center",label:"用户手机"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.tel))])]}}])}),e._v(" "),n("el-table-column",{attrs:{"min-width":"240px",align:"center",label:"用户地址"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(a.address))])]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"200px",align:"center",label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(e._s(e.roleName(a.roles)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{width:"160px","class-name":"status-col",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{disabled:!!t.row.disable,type:"primary",size:"mini"},on:{click:function(n){return e.grant(t.row)}}},[e._v("\n          权限变更\n        ")])]}}])})],1),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-size":e.listQuery.limit,layout:"prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)},"current-change":e.handleCurrentChange}})],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,title:"权限变更"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.user,"label-width":"80px","label-position":"left"}},[n("el-form-item",{attrs:{label:"用户名字"}},[e._v("\n        "+e._s(e.user.name)+"\n      ")]),e._v(" "),n("el-form-item",{attrs:{label:"角色名字"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeDisabled},model:{value:e.user.roles,callback:function(t){e.$set(e.user,"roles",t)},expression:"user.roles"}},e._l(e.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n        取消\n      ")]),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.confirmUser}},[e._v("\n        确认\n      ")])],1)],1)],1)},l=[],r=(n("7f7f"),n("20d6"),n("96cf"),n("3b8d")),s=(n("ac6a"),n("c24f")),i=n("cc5e"),o={data:function(){return{disabled:!0,dialogVisible:!1,total:0,listQuery:{page:1,limit:10,sort:"+id",search:{key:"",value:""}},loading:!1,user:{},usersList:[],options:[],value:""}},created:function(){this.getList(),this.getRoles()},methods:{changeDisabled:function(){this.disabled=!1},roleName:function(e){var t="查不到该用户的角色";return this.options.forEach((function(n){e===n.value&&(t=n.label)})),t},confirmUser:function(){var e=this;this.$confirm("确认修改","确认操作",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.options&&e.options.forEach((function(t){t.value===e.user.roles&&(e.user.roleName=t.label)})),Object(s["f"])({id:e.user._id,roleId:e.user.roles,roleName:e.user.roleName}).then((function(t){var n=e.usersList.findIndex((function(t){return t._id===e.user._id}));e.usersList.splice(n,1,e.user),e.$message({type:"success",message:"修改成功"}),e.disabled=!0,e.dialogVisible=!1}));case 2:case"end":return t.stop()}}),t)})))).catch((function(e){console.log(e)}))},getRoles:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,Object(i["d"])();case 3:n=e.sent,n.data.forEach((function(e){t.options.push({label:e.name,value:e._id})}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleCurrentChange:function(){this.getList()},getList:function(){var e=this;this.loading=!0,Object(s["a"])(this.listQuery).then((function(t){e.usersList=t.data.items,e.total=t.data.total,e.loading=!1}))},grant:function(e){this.dialogVisible=!0,this.user=JSON.parse(JSON.stringify(e))}}},u=o,c=n("2877"),d=Object(c["a"])(u,a,l,!1,null,null,null);t["default"]=d.exports}}]);